<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title></title></head><body><h1>Tryhackme&#39;s Mr.Robot CTF</h1>

<h4>Our nmap scan yielded these results:</h4>

<p><img src="../Downloads/img1.png" alt=""></p>

<h4>So off to the webpage we go!</h4>

<h4>When we first load up the page, we get this command-line interface with a set of options:</h4>

<p><img src="../Downloads/img2.png" alt=""></p>

<h4>My first thought is to try to run commands such as whoami or ls but the only available commands are the ones listed:</h4>

<ul>
<li>The prepare command brings us to a video</li>
<li>The fsociety command brings us to a shorter video</li>
<li>inform brings us to a set of images</li>
<li>question brings us to another set of images</li>
<li>wakeup brings us to a short clip from the Mr. Robot series</li>
<li>join brings us to a terminal which has us enter our email</li>
</ul>

<h4>My second thought is accessing these images &amp; videos and seeing what else is in the directories, but sadly:</h4>

<p><img src="../Downloads/img3.png" alt=""></p>

<h4>It&#39;s not allowed for any of the directories</h4>

<h4>I then decided to enter a random directory that I knew wouldn&#39;t exist to see what type of error message I would get and boom:</h4>

<p><img src="../Downloads/img4.png" alt=""></p>

<h4>It&#39;s a Wordpress blog!</h4>

<h4>I then checked the hints button on the CTF website and it just said robots, so I navigated to /robots.txt which shows what is accessible and what isn&#39;t on websites:</h4>

<p><img src="../Downloads/img5.png" alt=""></p>

<h4>Navigating to /key-1-of-3.txt will get us our first key</h4>

<h4>Navigating to /fsocity.dic will get us what appears to be a wordlist:</h4>

<p><img src="../Downloads/img6.png" alt=""></p>

<h4>A veeerrry long wordlist that is:</h4>

<p><img src="../Downloads/img7.png" alt=""></p>

<h4>And can I just question, how on Earth did fsociety get spelled wrong?</h4>

<h4>At first, I thought the wordlist was for subdirectories, and after about an hour of letting ffuf run, this was about all I discovered:</h4>

<p><img src="../Downloads/img8.png" alt=""></p>

<h4>So then I realized it may be a password list and I tried the obvious /login directory and ended up guessing the username would be Elliot since it&#39;s a Mr.Robot themed machine &amp; brute forced it with the fsociety.dic file</h4>

<h4>And boom! Access granted:</h4>

<p><img src="../Downloads/img9.png" alt=""></p>

<h4>Now we can access all the media on the site:</h4>

<p><img src="../Downloads/img10.png" alt=""></p>

<h4>After navigating to the appearance &gt; editor section, we can edit any of the PHP scripts on the website, which makes gaining access fairly simple:</h4>

<p><img src="../Downloads/img11.png" alt=""></p>

<h4>I chose to edit the 404 Template as this is what will pop up any time a directory isn&#39;t found, so for example: trying to access /jibberish-words would lead to us spawning a shell but you can choose any PHP script on here</h4>

<h4>After gaining our initial foothold, we gain an interactive shell, not only does this look better, it is also needed for some commands such as su:</h4>

<p><img src="../Downloads/img12.png" alt=""></p>

<h4>Key 2 found! But unfortunately we don&#39;t have the needed permissions to read the file:</h4>

<p><img src="../Downloads/img13.png" alt=""></p>

<h4>But! We do have the appropriate permissions to read the password.raw-md5 file:</h4>

<p><img src="../Downloads/img14.png" alt=""></p>

<h4>Next stop, <a href="https://crackstation.net">crackstation</a> where there are pre-cracked hashes you can compare your hash to in order to see if it&#39;s been cracked before.</h4>

<h4>Guess what?</h4>

<p><img src="../Downloads/img15.png" alt=""></p>

<h4>I&#39;m pretty sure this password was also in the fsocity.dic wordlist from earlier too</h4>

<h4>After using that password to gain access to the robot user, we&#39;re able to get the 2nd flag.</h4>

<h4>For the final flag, we need root access to the machine, this is the part I struggled with as I am not the most informed individual when it comes to privesc</h4>

<h4>To start off, I searched for files that have SUID set which is basically an owner&#39;s permission set to a file, so when a regular user runs it, it runs with the owner&#39;s permission and sometimes that owner is root:</h4>

<p><img src="../Downloads/img16.png" alt=""></p>

<h4>nmap with SUID? Seemed kinda odd to me, this basically means nmap runs with someone&#39;s permissions, perhaps root?</h4>

<p><img src="../Downloads/img17.png" alt=""></p>

<h4>The interactive mode was out of the norm for me:</h4>

<p><img src="../Downloads/img18.png" alt=""></p>

<h4>So you can run shell cmds with nmap&#39;s interactive mode and this will have someone else&#39;s permissions, but whose permissions?</h4>

<p><img src="../Downloads/img19.png" alt=""></p>

<h4>Boom, rooted, technically right?</h4>

<p><img src="../Downloads/img20.png" alt=""></p>

<h4>and there&#39;s our 3rd key!</h4>

<h4>Looping back though, I attempted to get linpeas on this machine by using a simple python server but for some reason, it wasn&#39;t working. Here&#39;s the output I was getting:</h4>

<p><img src="../Downloads/img211.png" alt=""></p>

<h4>Thinking it over though, I may have been able to get linpeas on the box through curl instead of wget.</h4>

<h4>But we are able to get linpeas on the machine with nmap since it runs with root&#39;s permissions, so IF we were able to run it once we gained our initial foothold, it would&#39;ve detected &amp; suggested the nmap route to rooting the box:</h4>

<p><img src="../Downloads/img23.png" alt=""></p>

<h4>I&#39;m not entirely sure why it says &ldquo;You can write SUID file&rdquo;, but there ya have it!</h4>
</body></html>